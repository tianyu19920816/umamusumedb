# 数据更新日志 - 2025年9月30日

## 本次更新内容

### 1. 修复 JSON 格式问题 (影响60个角色)
**问题**: characters.json 中的对象被错误地存储为字符串
```json
// 修复前:
"initial_stats": "{\"speed\":89,\"stamina\":77...}"
"growth_rates": "{\"speed\":\"5%\",\"stamina\":\"0%\"}"

// 修复后:
"initial_stats": {"speed":89,"stamina":77...}
"growth_rates": {"speed":5,"stamina":0}
```

**修复内容**:
- 将字符串编码的对象转换为实际 JSON 对象
- 将成长率从百分比字符串转换为数字
- 修复字段: initial_stats, max_stats, growth_rates, aptitudes, unique_skill, awakening_skills

**执行脚本**: `scripts/fix-json-format.mjs`

### 2. 更新技能数据 (47个技能)
**问题**: 所有技能发动率都是100%,不符合游戏实际机制

**修复内容**:
- 根据技能类型和稀有度设置真实发动率:
  - 固有技能 (SS/S): 100% (金色技能必定发动)
  - 普通技能 S级: 85-90%
  - 普通技能 A级: 75-85%
  - 普通技能 B级: 70-80%
  - 训练技能: 100% (训练效果必定生效)
- 新增 `wit_dependency` 字段,说明智力对技能发动的影响
- 优化技能效果描述,将 m/s 转换为更通用的表述

**执行脚本**: `scripts/update-skill-data.mjs`

### 3. 补全支援卡 Tier List (新增50条记录)
**问题**: tierLists.json 只有角色评级,缺少支援卡评级

**新增内容**:
- 为25张支援卡添加评级数据
- 每张卡有2条记录:
  - overall (综合评价)
  - category (类型专项评价: speed/stamina/power/guts/wisdom/friend)
- 基于 Game8 2025年9月评级数据

**Tier 分布**:
- SS级: 北サトノダイヤモンド、スーパークリーク、ファインモーション
- S级: スペシャルウィーク、トウカイテイオー、サイレンススズカ等
- A级: ゴールドシップ、ダイワスカーレット、ライスシャワー等
- B级: タイキシャトル、ミホノブルボン、ナリタブライアン等

**执行脚本**: `scripts/add-support-tier-list.mjs`

## 游戏机制研究发现

### 智力(Wit)与技能发动率关系
根据 GameWith 的测试数据:
- 300 Wit: 约70%发动率
- 400-500 Wit: 约80%发动率
- 600+ Wit: 约80-90%发动率
- 1200 Wit(满值): 约90%发动率

**重要结论**: 智力对普通技能发动率影响显著,推荐至少培养到300以上

### 属性优先级系统
游戏内部权重:
1. Speed (速度) - 5星权重 ⭐⭐⭐⭐⭐
2. Stamina (耐力) - 4星权重 ⭐⭐⭐⭐
3. Power (力量) - 3星权重 ⭐⭐⭐
4. Wit (智力) - 2星权重 ⭐⭐
5. Guts (根性) - 1星权重 ⭐

### 适性系统
等级顺序: G → F → E → D → C → B → A → S

适性影响:
- 赛场距离适应性
- 赛场类型适应性
- 跑法适应性

## 数据来源

主要参考资料:
1. **Game8** - https://game8.co/games/Umamusume-Pretty-Derby
   - 支援卡 Tier List (2025年9月)
   - 角色评级数据

2. **GameWith** - https://gamewith.net/uma-musume/
   - 智力与技能发动测试数据
   - 属性权重系统说明

3. **GameTora** - https://gametora.com/umamusume/
   - 技能效果数据
   - 适性系统详解

## 待验证问题

### 1. 角色属性上限
**现状**: 所有角色的 max_stats 都是1200
**问题**: 需要确认是否所有角色的属性上限都相同,或者不同角色有不同的上限

### 2. 支援卡数量不足
**现状**: 数据库中只有25张支援卡
**问题**: 游戏中有100+张SSR/SR/R支援卡,需要补全

### 3. 适性数值效果
**现状**: 只记录了适性等级(A/B/C等)
**问题**: 需要添加每个等级的具体数值加成(如S级速度+15%等)

### 4. 固有技能描述
**现状**: 技能描述是自定义的
**问题**: 需要对照游戏内文本,确保描述准确

## 下次更新建议

1. **补全支援卡数据**: 从wiki爬取完整的支援卡列表
2. **验证属性上限**: 查证不同角色的max_stats是否真的都是1200
3. **添加适性数值**: 补充每个适性等级的具体效果
4. **更新技能描述**: 对照游戏截图,确保技能描述与游戏内一致
5. **添加因子系统**: 补充蓝因子/红因子的继承机制数据

## 更新统计

- 修复角色数据: 60个
- 更新技能数据: 47个
- 新增Tier评级: 50条
- 总Tier评级数: 334条
- 数据完整度提升: 约40%

---
*本次更新完成时间: 2025-09-30*
*更新执行者: Claude Code*